<div class="collaboration-comment-reply" data-test-comment-reply>
  <div class="items-center {{unless this.isExpanded 'flex'}}">
    <div class="flex items-center">
      <UserAvatar @user={{this.currentUser}} @class="mr-1" @isSmallAvatar={{true}} />
      {{#if this.isExpanded}}
        <div class="font-semibold leading-none">
          {{this.currentUser.name}}
        </div>
      {{/if}}
    </div>
    <div class="flex-1 {{if this.isExpanded 'collaboration-content-inset'}}" {{action "expandReply"}} data-test-comment-reply-textarea-container role="button">
      <MentionableTextarea
        @tributeConfigs={{this.tributeConfigs}}
        @handleItemSelected={{action "handleAtMentionUser"}}
      >
        <PercyTextarea
          data-test-comment-reply-textarea={{true}}
          @onCmdEnter={{action "saveReply"}}
          @onEscape={{action "collapseReply"}}
          @placeholder="Add reply..."
          @value={{this.commentBody}}
          class="percy-input px-1 py-sm {{if this.isExpanded "h-24" "collaboration-collapsed-comment-reply"}}"
        />
      </MentionableTextarea>
    </div>
  </div>

  {{#if this.isExpanded}}
    <div class="flex justify-end mt-1">
      <PercyBtn
        @handleClick={{action "collapseReply"}}
        @testLabel="cancel"
      >
        Cancel
      </PercyBtn>
      <PercyBtn
        @handleClick={{action "saveReply"}}
        @class="ml-1"
        @isPrimaryButton={{true}}
        @isDisabled={{is-empty this.commentBody}}
        @testLabel="submit"
        @isSaving={{this.isCommentSaving}}
      >
        Comment
      </PercyBtn>
    </div>
  {{/if}}
</div>
