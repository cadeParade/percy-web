{{#lazy-loading-snapshot-item
  shouldFullyRender=shouldFullyRender
  displayTitle=groupTitle
}}
  <header class="SnapshotViewer-header sticky pin-t grid gap-4 z-1 px-2 py-1 bg-gray-000 border-t border-b" {{action "expandBlock"}} data-test-snapshot-group-header>
    <div style="min-width: 0;" class="flex items-center">
      <div class="Viewer-header-title SnapshotViewer-title cursor-default font-bold truncate" title="{{snapshots.length}} matching changes" data-test-snapshot-group-name>
        {{groupTitle}}
      </div>
    </div>

    <div class="flex justify-end">
      <div class="btn-toolbar">
        {{#if (not areAllSnapshotsExpanded)}}
          <div class="btn-group btn-group-alt">
            {{comparison-switcher
              comparisons=filteredComparisons.comparisonsWithDiffs
              selectedWidth=blockSelectedWidth
              updateSelectedWidth=(action "updateSelectedWidth")
            }}
          </div>
        {{/if}}

        {{#if (not areAllSnapshotsExpanded)}}
          <div class="btn-group" role="group" aria-label="Second Group">
            <button type="button" class="ToggleFullViewButton btn btn-square maximize-snapshot"
              {{action showSnapshotFullModalTriggered snapshots.firstObject.id blockSelectedWidth activeBrowser}} data-test-snapshot-header-dropdown-toggle>
              <figure class="svg-container">
                {{inline-svg "maximize-icon"}}
              </figure>
            </button>
          </div>
        {{/if}}

        <div class="btn-toolbar">
          <div class="btn-group">
            <button class="percy-btn" {{action (toggle "areAllSnapshotsExpanded" this)}} data-test-show-group-snapshots>
              {{#if areAllSnapshotsExpanded}}
                Collapse Matches
              {{else}}
                Expand Matches
              {{/if}}
            </button>
          </div>
          <div class="btn-group">
            {{group-approval-button
              createReview=createReview
              approvableSnapshots=approvableSnapshots
              numTotalSnapshots=snapshots.length
              numUnapprovedSnapshots=numUnapprovedSnapshots
              isGroupApproved=isGroupApproved
              isDisabled=(not isBuildApprovable)
            }}
          </div>
        </div>
      </div>
    </div>
  </header>

  <div class="mt-2">
    {{#if isExpanded}}
      {{#unless areAllSnapshotsExpanded}}
        {{comparison-viewer
          comparison=selectedComparison
          allDiffsShown=false
          snapshotSelectedWidth=blockSelectedWidth
          isDefaultExpanded=true
          isUnchangedSnapshotExpanded=true
          activeBrowser=activeBrowser
        }}
      {{else}}
        {{#each snapshots as |snapshot|}}
          {{snapshot-viewer
            build=build
            snapshot=snapshot
            allDiffsShown=allDiffsShown
            activeSnapshotBlockId=activeSnapshotBlockId
            shouldDeferRendering=shouldDeferRendering
            showSnapshotFullModalTriggered=showSnapshotFullModalTriggered
            createReview=createReview
            updateActiveSnapshotBlockId=updateActiveSnapshotBlockId
            activeBrowser=activeBrowser
            updateActiveBrowser=updateActiveBrowser
            isBuildApprovable=isBuildApprovable
            class="ml-8 mr-2 mt-2 border-l border-r"
          }}
        {{/each}}
      {{/unless}}
    {{/if}}
  </div>
{{/lazy-loading-snapshot-item}}
